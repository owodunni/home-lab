---
# Longhorn Helm Values
# Distributed block storage for Kubernetes persistent volumes

defaultSettings:
  # Replica count: 1 (we have 1 worker node with storage)
  defaultReplicaCount: "1"
  # Data locality: prefer storing data on same node as workload
  defaultDataLocality: best-effort
  # Soft anti-affinity: allow replicas on same node if needed
  replicaSoftAntiAffinity: "true"
  # S3 backup target configuration for MinIO
  backupTarget: s3://longhorn-backups@eu-west-1/
  backupTargetCredentialSecret: minio-secret
  # CRITICAL: Restore backup job assignments during disaster recovery
  restoreVolumeRecurringJobs: "true"

longhornUI:
  replicas: 1

persistence:
  # Make Longhorn the default storage class
  defaultClass: true
  defaultFsType: ext4
  defaultClassReplicaCount: 1 # Matches infrastructure
  # Retain volumes when PVC is deleted (safety)
  reclaimPolicy: Retain

csi:
  # K3s v0.10.0+ uses standard kubelet path
  # See: https://longhorn.io/docs/1.10.0/advanced-resources/
  #      os-distro-specific/csi-on-k3s/
  kubeletRootDir: /var/lib/kubelet

longhornManager:
  nodeSelector:
    kubernetes.io/os: linux

longhornDriver:
  nodeSelector:
    kubernetes.io/os: linux

# Ingress configuration for Longhorn UI
ingress:
  enabled: true
  ingressClassName: traefik
  host: longhorn.jardoole.xyz
  tls: true
  tlsSecret: longhorn-tls-secret
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt-prod
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
